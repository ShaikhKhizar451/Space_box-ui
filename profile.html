<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Favicon -->
    <link href="assets/images/favicon.png" rel="icon" type="image/png">

    <!-- Basic Page Needs
        ================================================== -->
    <title>Space Box Sharing Photos</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Space Box - Sharing Photos platform HTML Template">

    <!-- icons
        ================================================== -->
    <link rel="stylesheet" href="assets/css/icons.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/emojionearea/3.4.2/emojionearea.min.css" />

    <!-- CSS 
        ================================================== -->
    <link rel="stylesheet" href="assets/css/uikit.css">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/tailwind.css">
    <style>
        @media (min-width: 1024px) {
            header .header_inner {
                max-width: 980px;
            }

            .pro-container {
                max-width: 860px;
            }
        }
    </style>




</head>

<body onload="onloadFunction()">


    <div id="wrapper">

        <div class="sidebar">
            <div
                class="sidebar_header border-b border-gray-200 from-gray-100 to-gray-50 bg-gradient-to-t  uk-visible@s">
                <a href="feed.html">
                    <img src="assets/images/logo.png">
                    <img src="assets/images/logo-light.png" class="logo_inverse">
                </a>
                <!-- btn night mode -->
                <a href="#" id="night-mode" class="btn-night-mode" data-tippy-placement="left"
                    title="Switch to dark mode"></a>
            </div>
            <div class="border-b border-gray-20 flex justify-between items-center p-3 pl-5 relative uk-hidden@s">
                <h3 class="text-xl"> Navigation </h3>
                <span class="btn-mobile" uk-toggle="target: #wrapper ; cls: sidebar-active"></span>
            </div>
            <div class="sidebar_inner" data-simplebar>
                <div class="flex flex-col items-center my-6 uk-visible@s">
                    <div
                        class="bg-gradient-to-tr from-yellow-600 to-pink-600 p-1 rounded-full transition m-0.5 mr-2  w-32 h-32">
                        <img src="" class="bg-gray-200 border-4 border-white rounded-full w-full h-full profilePicture">
                    </div>
                    <a href="profile.html" id="fullNameTag" class="text-xl font-medium capitalize mt-4 uk-link-reset">
                    </a>
                    <p hidden id="bio"></p>
                    <div class="flex justify-around w-full items-center text-center uk-link-reset text-gray-800 mt-6">
                        <div>
                            <a href="#">
                                <strong>Post</strong>
                                <div id="noOfPost"></div>
                            </a>
                        </div>
                        <div>
                            <a href="#">
                                <strong>Following</strong>
                                <div id="following"></div>
                            </a>
                        </div>
                        <div>
                            <a href="#">
                                <strong>Followers</strong>
                                <div id="followers"></div>
                            </a>
                        </div>
                    </div>
                </div>
                <hr class="-mx-4 -mt-1 uk-visible@s">
                <ul>
                    <li>
                        <a href="feed.html">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" />
                            </svg>
                            <span> Feed </span> </a>
                    </li>
                    <li class="active">
                        <a href="profile.html">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                            </svg>
                            <span> My Profile </span> </a>
                    </li>
                    <li>
                        <a href="setting.html">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                            </svg>
                            <span> Settings </span>
                        </a>
                    </li>
                    <li>
                        <hr class="my-2">
                    </li>
                    <li>
                        <a onclick="logout()">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                            </svg>
                            <span> Logout </span> </a>
                    </li>
                </ul>
            </div>
        </div>

        <div class="main_content">

            <header>
                <div class="header_inner">
                    <div class="left-side">
                        <!-- Logo -->
                        <div id="logo" class=" uk-hidden@s">
                            <a href="feed.html">
                                <img src="assets/images/logo-mobile.png" alt="">
                                <img src="assets/images/logo-mobile-light.png" class="logo_inverse">
                            </a>
                        </div>

                        <div class="triger" uk-toggle="target: #wrapper ; cls: sidebar-active">
                            <i class="uil-bars"></i>
                        </div>

                        <div class="header_search">
                            <input type="text" placeholder="Search..">
                            <div class="icon-search">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                                    stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                                </svg>
                            </div>
                        </div>

                    </div>
                    <div class="right-side lg:pr-4">
                        <!-- upload -->
                        <a href="#post-modal" uk-toggle
                            class="bg-pink-500 flex font-bold hidden hover:bg-pink-600 hover:text-white inline-block items-center lg:block max-h-10 mr-4 px-4 py-2 rounded shado text-white">
                            <ion-icon name="add-circle" class="-mb-1
                             mr-1 opacity-90 text-xl uilus-circle"></ion-icon> Upload
                        </a>

                        <!-- profile -->

                        <a href="#">
                            <img src="" class="header-avatar profilePicture" alt="">
                        </a>
                        <div uk-drop="mode: click;offset:9" class="header_dropdown profile_dropdown border-t">
                            <ul>
                                <li><a href="setting.html"> Account setting </a> </li>
                                <li><a href="form-login.html"> Log Out</a></li>
                            </ul>
                        </div>

                    </div>
                </div>
            </header>

            <div class="container pro-container m-auto">

                <!-- profile-cover-->
                <div class="flex lg:flex-row flex-col items-center lg:py-8 lg:space-x-8">

                    <div>
                        <div
                            class="bg-gradient-to-tr from-yellow-600 to-pink-600 p-1 rounded-full m-0.5 mr-2  w-56 h-56 relative overflow-hidden uk-transition-toggle">
                            <img src=""
                                class="bg-gray-200 border-4 border-white rounded-full w-full h-full dark:border-gray-900 profilePicture">
                        </div>
                    </div>

                    <div class="lg:w/8/12 flex-1 flex flex-col lg:items-start items-center">

                        <h2 class="font-semibold lg:text-2xl text-lg mb-2" id="ProfilefullNameTag"></h2>
                        <p class="lg:text-left mb-2 text-center  dark:text-gray-100" id="ProfileBio"> </p>


                        <div class="capitalize flex font-semibold space-x-3 text-center text-sm my-2">
                            <a href="setting.html" class="bg-gray-300 shadow-sm p-2 px-4 rounded-md dark:bg-gray-700">
                                Edit Your Profile
                                <ion-icon name="pencil" class="-mb-1
                             opacity-90 text-xl uilus-circle"></ion-icon></a>
                        </div>

                        <div
                            class="divide-gray-300 divide-transparent divide-x grid grid-cols-3 lg:text-left lg:text-lg mt-3 text-center w-full dark:text-gray-100">
                            <div class="flex lg:flex-row flex-col"><span id="ProfilePost"></span><strong
                                    class="lg:pl-2"> Posts</strong></div>
                            <div class="lg:pl-4 flex lg:flex-row flex-col"><span id="ProfileFollowers"></span><strong
                                    class="lg:pl-2"> Followers</strong></div>
                            <div class="lg:pl-4 flex lg:flex-row flex-col"><span id="ProfileFollowing"></span><strong
                                    class="lg:pl-2"> Following</strong></div>
                        </div>

                    </div>

                    <div class="w-20"></div>

                </div>


                <div class="flex items-center justify-between mt-8 space-x-3">
                    <h1
                        class="flex-1 font-extrabold leading-none lg:text-2xl text-lg text-gray-900 tracking-tight uk-heading-line">
                        <span>Post</span>
                    </h1>
                    <div
                        class="bg-white border border-2 border-gray-300 divide-gray-300 divide-x flex rounded-md shadow-sm dark:bg-gray-100">

                    </div>
                </div>

                <div class="my-6 grid lg:grid-cols-4 grid-cols-2 gap-1.5 hover:text-yellow-700 uk-link-reset"
                    id="all_post">
                    <p>No Post To Show</p>
                </div>
            </div>
        </div>
    </div>


    <!-- Story modal -->
    <div id="story-modal" class="uk-modal-container" uk-modal>
        <div class="uk-modal-dialog story-modal">
            <button
                class="uk-modal-close-default lg:-mt-9 lg:-mr-9 -mt-5 -mr-5 shadow-lg bg-white rounded-full p-4 transition dark:bg-gray-600 dark:text-white"
                type="button" uk-close></button>

            <div class="story-modal-media" id="postlink">
            </div>
            <div class="flex-1 bg-white dark:bg-gray-900 dark:text-gray-100">

                <!-- post header-->
                <div class="border-b flex items-center justify-between px-5 py-3 dark:border-gray-600">
                    <div class="flex flex-1 items-center space-x-4">
                        <a href="#">
                            <div class="bg-gradient-to-tr from-yellow-600 to-pink-600 p-0.5 rounded-full">
                                <img src="" id="profilePic"
                                    class="bg-gray-200 border border-white rounded-full w-8 h-8">
                            </div>
                        </a>
                        <span class="block text-lg font-semibold" id="name"> </span>
                    </div>
                    <div>
                        <a href="#"> <i
                                class="icon-feather-more-horizontal text-2xl hover:bg-gray-200 rounded-full p-2 transition -mr-1 dark:hover:bg-gray-700"></i>
                        </a>
                        <div class="bg-white w-56 shadow-md mx-auto p-2 mt-12 rounded-md text-gray-500 hidden text-base border border-gray-100 dark:bg-gray-900 dark:text-gray-100 dark:border-gray-700"
                            uk-drop="mode: hover;pos: top-right">

                            <ul class="space-y-1">
                                <li>
                                    <a href="#" onclick="hideCommentPart()"
                                        class="flex items-center px-3 py-2 hover:bg-gray-200 hover:text-gray-800 rounded-md dark:hover:bg-gray-800">
                                        <i class="uil-edit-alt mr-1"></i> Edit Post Caption
                                    </a>
                                </li>
                                <li>
                                    <hr class="-mx-2 my-2 dark:border-gray-800">
                                </li>
                                <li>
                                    <a href="#" id="deleteBtn" onclick="deletePost(this)" data-mediaid=""
                                        class="flex items-center px-3 py-2 text-red-500 hover:bg-red-100 hover:text-red-500 rounded-md dark:hover:bg-red-600">
                                        <i class="uil-trash-alt mr-1"></i> Delete
                                    </a>
                                </li>
                            </ul>

                        </div>
                    </div>
                </div>
                <p id="caption"> </p>
                <div class="story-content p-4" data-simplebar id="commentSection">



                    <div class="py-4 ">
                        <hr class="-mx-4 my-3">
                        <div class="flex items-center space-x-3">
                            <div class="flex items-center">
                                <img src="assets/images/avatars/avatar-1.jpg" alt=""
                                    class="w-6 h-6 rounded-full border-2 border-white">
                                <img src="assets/images/avatars/avatar-4.jpg" alt=""
                                    class="w-6 h-6 rounded-full border-2 border-white -ml-2">
                                <img src="assets/images/avatars/avatar-2.jpg" alt=""
                                    class="w-6 h-6 rounded-full border-2 border-white -ml-2">
                            </div>
                            <div>
                                Liked <strong> Johnson</strong> and <strong> 209 Others </strong>
                            </div>
                        </div>
                    </div>

                    <div class="-mt-1 space-y-1">
                        <div class="flex flex-1 items-center space-x-2">
                            <img src="assets/images/avatars/avatar-2.jpg" class="rounded-full w-8 h-8">
                            <div class="flex-1 p-2">
                                consectetuer adipiscing elit, sed diam nonummy nibh euismod
                            </div>
                        </div>

                        <div class="flex flex-1 items-center space-x-2">
                            <img src="assets/images/avatars/avatar-4.jpg" class="rounded-full w-8 h-8">
                            <div class="flex-1 p-2">
                                consectetuer adipiscing elit
                            </div>
                        </div>

                    </div>


                </div>
                <div class="p-3 border-t dark:border-gray-600">
                    <div class="bg-gray-200 dark:bg-gray-700 rounded-full rounded-md relative" id="textareaCaption">
                        <input id="UpdatedCaption" type="text" placeholder="Add your Comment.."
                            class="bg-transparent max-h-8 shadow-none">
                        <div class="absolute bottom-0 flex h-full items-center right-0 right-3 text-xl space-x-2">
                            <a onclick="UpdatePostCaption(this)" id="btnSubmitCaption" data-mediaId=""> <i
                                    class="uil-message"></i></a>
                        </div>
                    </div>
                </div>

            </div>

        </div>
    </div>

    <!-- Modal For upload Post -->
    <div id="post-modal" class="uk-modal-container" uk-modal>
        <div class="uk-modal-dialog post-modal" style="width: 900px;">
            <button
                class="uk-modal-close-default lg:-mt-9 lg:-mr-9 -mt-5 -mr-5 shadow-lg bg-white rounded-full p-4 transition dark:bg-gray-600 dark:text-white"
                type="button" uk-close></button>

            <div class="flex-1 bg-white dark:bg-gray-900 dark:text-gray-100">

                <!-- post header-->
                <div class="border-b flex items-center justify-between px-5 py-3 dark:border-gray-600">
                    <div class="flex flex-1 items-center space-x-4">
                        <a href="#">
                            <div class="bg-gradient-to-tr from-yellow-600 to-pink-600 p-0.5 rounded-full">
                                <img src="assets/images/avatars/avatar-2.jpg"
                                    class="bg-gray-200 border border-white rounded-full w-8 h-8">
                            </div>
                        </a>
                        <span class="block text-lg font-semibold"> Johnson smith </span>
                    </div>
                </div>
                <div class="flex flex-col choose-upload text-center">

                    <div
                        class="bg-gray-100 border-2 border-dashed flex flex-col h-24 items-center justify-center relative w-full rounded-lg dark:bg-gray-800 dark:border-gray-600">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-12">
                            <path
                                d="M5.5 13a3.5 3.5 0 01-.369-6.98 4 4 0 117.753-1.977A4.5 4.5 0 1113.5 13H11V9.413l1.293 1.293a1 1 0 001.414-1.414l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L9 9.414V13H5.5z" />
                            <path d="M9 13h2v5a1 1 0 11-2 0v-5z" />
                        </svg>
                    </div>

                    <p class="my-3 leading-6" id="afteruploadtext"> please upload here ..
                    </p>
                    <form action="" method="post" id="formElem">
                        <div uk-form-custom>
                            <input type="file" id="postImg" accept=".png,.jpg,.mp4,.jpeg,.gif,.webm,.ogg,.mkv" required
                                onchange="return fileValidationForPost()">
                            <a href="#" class="button soft-warning small"> Choose file</a>
                        </div>
                        <div class="grid grid-cols-1 gap-4 lg:p-6 p-4">
                            <div>
                                <input type="text" placeholder="*Write a caption..." class="shadow-none bg-gray-100"
                                    id="uploadCaption" required>
                            </div>
                            <div>
                                <button class="button soft-warning small" type="submit" id="submit">Share</button>
                            </div>
                    </form>
                </div>
            </div>
        </div>

    </div>

    <script>

        (function (window, document, undefined) {
            'use strict';
            if (!('localStorage' in window)) return;
            var nightMode = localStorage.getItem('gmtNightMode');
            if (nightMode) {
                document.documentElement.className += ' dark';
            }
        })(window, document);


        (function (window, document, undefined) {

            'use strict';

            // Feature test
            if (!('localStorage' in window)) return;

            // Get our newly insert toggle
            var nightMode = document.querySelector('#night-mode');
            if (!nightMode) return;

            // When clicked, toggle night mode on or off
            nightMode.addEventListener('click', function (event) {
                event.preventDefault();
                document.documentElement.classList.toggle('dark');
                if (document.documentElement.classList.contains('dark')) {
                    localStorage.setItem('gmtNightMode', true);
                    return;
                }
                localStorage.removeItem('gmtNightMode');
            }, false);

        })(window, document);
    </script>

    <!-- Scripts
    ================================================== -->
    <script src="assets/js/tippy.all.min.js"></script>
    <script src="assets/js/jquery-3.3.1.min.js"></script>
    <script src="assets/js/uikit.js"></script>
    <script src="assets/js/simplebar.js"></script>
    <script src="assets/js/custom.js"></script>


    <script src="https://unpkg.com/ionicons@5.2.3/dist/ionicons.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/emojionearea/3.4.2/emojionearea.min.js"></script>

    <script src="assets/js/common.js"></script>

    <script>
        async function onloadFunction() {
            verify();
            await getDefaultValues();
            getProfileInfo();
        }
        function hideCommentPart() {
            document.getElementById('commentSection').remove()
            // <textarea  id="caption" name="caption" id="" cols="30" rows="10" placeholder="Add your New Caption.." class="bg-transparent max-h-8 shadow-none"></textarea>
            $(document.getElementById('textareaCaption')).removeClass('rounded-full').addClass('rounded-half')
        }

        $('#uploadCaption').emojioneArea({
            pickerPosition: 'bottom'
        });

        $("input[type=file]").on('change', function () {
            $('#afteruploadtext')[0].innerHTML = 'You have Uploaded ' + this.files[0].name;
        });

        formElem.onsubmit = async (e) => {
            e.preventDefault();
            showloader();
            var input = document.querySelector('input[type="file"]')
            var data = new FormData();
            data.append('caption', document.getElementById('uploadCaption').value);
            data.append('likes', 0);
            data.append('created_on', new Date().toLocaleDateString([], { hour: '2-digit', minute: "2-digit", hour12: false }));
            data.append('file', input.files[0]);
            let response = await fetch('http://127.0.0.1:8000/create_post', {
                headers: myHeaders,
                method: 'post',
                body: data,
            });

            let result = await response.json();
            if (result == "Post Created Successfully") {
                alert("Post Created Successfully")
                window.location.reload();
            }
            else {
                alert("Something is wrong!!!")
            }
            hideloader();
        }

        async function UpdatePostCaption() {
            showloader();
            var caption = document.getElementById('UpdatedCaption').value;
            var id = document.getElementById('btnSubmitCaption').dataset.mediaid;
            let response = await fetch('http://127.0.0.1:8000/update_caption/' + id + '/' + caption, {
                headers: myHeaders,
                method: 'Put'
            });
            let result = await response.json();
            hideloader();
            alert(result);
            window.location.reload();
        }
        async function deletePost(data) {
            var id = data.dataset.mediaid;
            if (confirm('Are you sure you want to delete your post...?') == true) {
                showloader();
                let response = await fetch('http://127.0.0.1:8000/delete_post/' + id, {
                    headers: myHeaders,
                    method: 'delete'
                });
                if (response.status == 204) {
                    alert("Post Deleted Successfully...")
                }
                hideloader();
                window.location.reload();
            }
            else {
                alert("Post is not deleted Yet you data is saved...");
                window.location.reload();
            }
        }
        function getStoryModalForProfile(data) {
            UIkit.modal(document.getElementById('story-modal')).show();
            document.getElementById('profilePic').src = data.dataset.profilepic
            document.getElementById('name').innerHTML = data.dataset.name
            document.getElementById('caption').innerHTML = data.dataset.caption
            document.getElementById('btnSubmitCaption').dataset.mediaid = data.dataset.mediaid
            document.getElementById('deleteBtn').dataset.mediaid = data.dataset.mediaid
            isImage = data.dataset.isimage
            if (isImage == "true") {
                nodeImage = '<img src="' + data.dataset.postlink + '" alt="" class="inset-0 h-full w-full object-cover" style="width: 660px;">'
                document.getElementById('postlink').innerHTML = nodeImage;
            }
            else {
                nodeVideo = '<video id="postVideo" src="' + data.dataset.postlink + '" class="inset-0 h-full w-full object-cover" controls  style="width: 660px; max-height: 880px;"></video>'
                document.getElementById('postlink').innerHTML = nodeVideo;
                setInterval(function () { document.getElementById('postVideo').style.inlineSize = 'auto' }, 5000);
            }
        }
    </script>
    <style>
        video::-webkit-media-controls-fullscreen-button {
            pointer-events: none;
            opacity: .5;
        }
    </style>

</body>

</html>